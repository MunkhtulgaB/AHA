<!DOCTYPE html>
<html lang=en>

<head>
    <meta charset=utf-8>
    <style>
        body {
            margin:0px;
        }
        canvas {
            -webkit-touch-callout: none;
            -webkit-text-size-adjust: none;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
    
    <title>AHA! Draw</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/3.6.95/css/materialdesignicons.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script type="text/javascript" src="../script/plugins/drawr/dist/jquery.drawr.combined.js"></script>
</head>

<body>
    <div id="drawr-container3" style="width:500px;height:500px;border:2px dotted gray;margin:20px;">
        <canvas class="demo-canvas drawr-test3"></canvas>
    </div>
    <input type="file" id="file-picker" style="display:none;">
    
    <script type="text/javascript">
    
    
        $("#drawr-container3 .demo-canvas").drawr({ "enable_tranparency" : true });
    
        $("#drawr-container3 .demo-canvas").drawr("start");
        
        //add custom save button.
        var buttoncollection = $("#drawr-container3 .demo-canvas").drawr("button", {
            "icon":"mdi mdi-folder-open mdi-24px"
        }).on("touchstart mousedown",function(){
            //alert("demo of a custom button with your own functionality!");
            $("#file-picker").click();
        });
        var buttoncollection = $("#drawr-container3 .demo-canvas").drawr("button", {
            "icon":"mdi mdi-content-save mdi-24px"
        }).on("touchstart mousedown",function(){
            var imagedata = $("#drawr-container3 .demo-canvas").drawr("export","image/png");
            var element = document.createElement('a');
            element.setAttribute('href', imagedata);// 'data:text/plain;charset=utf-8,' + encodeURIComponent("sillytext"));
            element.setAttribute('download', "test.png");
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        });
        $("#file-picker")[0].onchange = function(){
            var file = $("#file-picker")[0].files[0];
            if (!file.type.startsWith('image/')){ return }
            var reader = new FileReader();
            reader.onload = function(e) { 
                $("#drawr-container3 .demo-canvas").drawr("load",e.target.result);
            };
            reader.readAsDataURL(file);
        };
    
    </script>    
</body>
</html>